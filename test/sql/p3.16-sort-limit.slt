# 10 pts

# Simple sort

# Default
query
select * from __mock_table_1 order by colB desc limit 10;
----
99 9900
98 9800
97 9700
96 9600
95 9500
94 9400
93 9300
92 9200
91 9100
90 9000


# Simple limit
query
select * from test_simple_seq_2 limit 5;
----
0 10
1 11
2 12
3 13
4 14


query
select * from test_simple_seq_2 limit 15;
----
0 10
1 11
2 12
3 13
4 14
5 15
6 16
7 17
8 18
9 19


# Harder Test with sort and limit

statement ok
create table temp_1(col1 int, col2 int, col3 int, col4 int, col5 int, col6 int, col7 int, col8 int);

# Select on empty table with sort
query
select * from temp_1 order by col1;
----

# testing sort on null / varchar

query
select * from __mock_table_tas_2025_fall order by github_id limit 5;
----
17zhangw Tuesday 
MrWhitezz Wednesday 
notSaranshMalik Friday 
quantumish Monday 
rayhhome Friday

query
select * from __mock_table_4 order by colH limit 3;
----
integer_null varlen_null 
integer_null varlen_null 
integer_null varlen_null 

query
select * from __mock_table_4 order by colH desc, colG asc limit 3;
----
integer_null ðŸ’©ðŸ’©ðŸ’© 
integer_null ðŸ’©ðŸ’©ðŸ’© 
integer_null ðŸ’©ðŸ’©ðŸ’© 

query
select * from __mock_table_4 order by colG desc nulls first, colH nulls last limit 3;
----
integer_null ðŸ’© 
integer_null ðŸ’© 
integer_null ðŸ’© 

query
select * from __mock_table_4 order by colG asc nulls last, colH limit 3;
----
1 ðŸ’© 
1 ðŸ’© 
1 ðŸ’© 

statement ok
insert into temp_1 values
    (196, 9, 79, 147, 766, 65018, 580420, 3460119),
    (96, 9, 73, 674, 5266, 132, 141779, 9085955),
    (5, 3, 21, 251, 2419, 4040, 454689, 8904729),
    (87, 7, 29, 129, 5132, 30303, 378736, 2741233),
    (18, 8, 10, 508, 1933, 54020, 125384, 813451),
    (75, 2, 41, 901, 593, 14227, 586302, 462945),
    (111, 3, 44, 700, 2024, 61402, 787437, 3015027),
    (39, 9, 84, 243, 4208, 14273, 384043, 1263705),
    (128, 6, 93, 735, 3749, 87702, 353590, 4995735),
    (41, 7, 67, 859, 1630, 8890, 346654, 2642419),
    (33, 2, 95, 120, 2284, 20382, 656992, 8703768),
    (124, 8, 69, 351, 4670, 77529, 139759, 8776939),
    (183, 5, 32, 390, 8718, 36152, 686749, 8919342),
    (91, 3, 1, 613, 2964, 87648, 509069, 7536978),
    (166, 8, 47, 552, 6515, 66148, 324278, 1957978),
    (107, 3, 1, 594, 267, 7803, 11909, 366568),
    (31, 0, 51, 921, 5840, 48429, 328862, 5960441),
    (148, 0, 66, 139, 2130, 78439, 204429, 1286350),
    (185, 9, 84, 831, 7327, 14708, 5597, 5096306),
    (100, 3, 56, 856, 1409, 5704, 921859, 8296737),
    (97, 1, 97, 644, 9674, 48009, 704186, 3668180),
    (160, 8, 70, 571, 7936, 22902, 603269, 8680300),
    (32, 9, 13, 285, 3097, 3996, 395731, 7687792),
    (48, 8, 58, 516, 1321, 9104, 689086, 7547836),
    (13, 7, 37, 597, 9695, 79132, 5913, 2729103),
    (51, 2, 85, 748, 2277, 90946, 543930, 5704145),
    (16, 7, 75, 814, 6433, 96606, 487369, 179266),
    (131, 0, 95, 665, 6705, 68624, 389457, 1055001),
    (110, 7, 94, 979, 7019, 26419, 268566, 9668807),
    (108, 3, 1, 410, 6820, 33364, 580756, 1818944),
    (156, 3, 48, 886, 4471, 7582, 242036, 5518578),
    (14, 7, 84, 815, 9372, 76305, 936436, 5246864),
    (168, 8, 7, 851, 2023, 46784, 687310, 4103789),
    (158, 4, 58, 294, 2711, 93255, 610740, 3917117),
    (176, 8, 34, 636, 7301, 47976, 569899, 9218292),
    (189, 7, 13, 452, 8596, 94212, 682893, 9647479),
    (151, 7, 94, 410, 6233, 91520, 940819, 7230491),
    (102, 2, 72, 523, 4379, 94749, 544165, 348734),
    (147, 6, 67, 708, 8020, 54656, 211346, 5425761),
    (146, 6, 4, 393, 6835, 88911, 568402, 4590957),
    (95, 0, 92, 180, 2635, 80737, 619176, 4947590),
    (98, 2, 84, 36, 5383, 54686, 90558, 3135289),
    (43, 2, 88, 577, 7009, 64800, 507828, 5295211),
    (191, 3, 51, 117, 3103, 67268, 135031, 8950927),
    (187, 1, 93, 803, 6104, 99815, 684391, 5519665),
    (12, 5, 43, 767, 7501, 9636, 83576, 5070120),
    (58, 4, 89, 871, 5347, 63473, 89035, 2890030),
    (49, 1, 46, 286, 9426, 40720, 93086, 9399852),
    (171, 1, 61, 381, 3526, 41471, 34075, 9185441),
    (71, 0, 29, 448, 3800, 82369, 975429, 3874917),
    (188, 1, 61, 916, 4058, 39604, 405586, 891694),
    (133, 9, 66, 345, 4546, 17571, 408146, 8155891),
    (80, 5, 48, 401, 6773, 66298, 835516, 5003483),
    (65, 7, 46, 226, 4705, 84312, 973089, 4319545),
    (132, 0, 44, 923, 7435, 1345, 783426, 5120786),
    (55, 3, 99, 134, 63, 13196, 284220, 1931990),
    (21, 3, 67, 366, 5218, 35569, 603781, 7963823),
    (64, 3, 18, 562, 124, 82284, 413419, 7469541),
    (115, 2, 57, 1, 2533, 10526, 806424, 6735507),
    (86, 1, 72, 47, 1864, 37709, 250122, 7133555),
    (165, 4, 80, 442, 2490, 73021, 924437, 7821936),
    (59, 5, 90, 876, 4518, 71072, 16420, 6697862),
    (123, 3, 92, 951, 9769, 96069, 331647, 2019560),
    (19, 7, 8, 866, 3594, 59865, 860895, 1147124),
    (37, 9, 44, 896, 6733, 59844, 347449, 4470115),
    (145, 3, 21, 711, 223, 65113, 247776, 6286926),
    (109, 5, 74, 631, 1617, 52223, 48765, 6012052),
    (89, 2, 31, 525, 9975, 21923, 618183, 3074793),
    (30, 8, 54, 165, 8934, 10717, 200689, 8326241),
    (135, 0, 31, 533, 4479, 43225, 675685, 4584830),
    (142, 8, 97, 665, 9823, 46844, 383619, 6444628),
    (159, 5, 10, 347, 4333, 81149, 467131, 3495302),
    (93, 4, 45, 49, 4327, 54773, 50210, 4033852),
    (52, 6, 91, 411, 3138, 55061, 585468, 5056821),
    (154, 6, 81, 983, 4486, 77159, 833103, 4968465),
    (67, 3, 70, 226, 2823, 80004, 895654, 437490),
    (60, 3, 61, 587, 3633, 53753, 972672, 9199994),
    (155, 4, 62, 858, 1135, 34382, 494514, 2959301),
    (61, 0, 21, 22, 5642, 21864, 313078, 9305193),
    (24, 3, 74, 425, 117, 3468, 896998, 9109877),
    (140, 1, 71, 21, 2828, 94610, 12838, 1212582),
    (57, 5, 7, 617, 2743, 70578, 773995, 2744737),
    (112, 8, 60, 77, 6057, 41809, 524022, 7077061),
    (105, 5, 54, 290, 2563, 96935, 232157, 4499459),
    (179, 7, 36, 79, 9115, 60534, 741330, 5927650),
    (82, 4, 91, 302, 1292, 75026, 888084, 8742272),
    (35, 3, 95, 13, 8753, 92210, 671499, 5205336),
    (172, 9, 22, 546, 8088, 89284, 964185, 39966),
    (198, 0, 99, 778, 1528, 52316, 726477, 8219397),
    (121, 7, 81, 746, 3116, 71628, 235086, 5966098),
    (77, 7, 89, 732, 5803, 94659, 898745, 7829986),
    (73, 1, 27, 586, 1410, 43828, 466258, 1943103),
    (0, 8, 5, 561, 9989, 87361, 494821, 5840702),
    (162, 1, 42, 929, 9622, 39856, 518843, 9852745),
    (116, 8, 77, 963, 5488, 30956, 928245, 7855578),
    (68, 5, 52, 373, 1322, 7952, 755240, 4880763),
    (120, 7, 16, 168, 6744, 9691, 204061, 4253805),
    (23, 4, 5, 322, 7775, 4410, 961809, 3225009),
    (1, 2, 31, 422, 4453, 7210, 206335, 2045026),
    (137, 5, 1, 930, 6654, 83304, 304305, 9773858),
    (186, 9, 78, 888, 7407, 52027, 924097, 8606329),
    (53, 9, 42, 211, 9846, 61097, 684453, 4213854),
    (169, 3, 81, 659, 3459, 2353, 207646, 9481338),
    (9, 5, 93, 106, 5472, 88331, 755124, 9894953),
    (177, 3, 37, 238, 8807, 29443, 358235, 7280614),
    (7, 8, 11, 154, 8374, 74676, 497239, 7923921),
    (27, 7, 8, 887, 4592, 68130, 997285, 8035102),
    (193, 8, 65, 708, 9371, 99964, 37220, 3893300),
    (126, 0, 98, 644, 8145, 5131, 900228, 86417),
    (79, 9, 28, 823, 8590, 23300, 806801, 9298308),
    (180, 4, 69, 230, 9161, 43700, 738588, 1671536),
    (136, 9, 75, 565, 8630, 41623, 545551, 2020603),
    (101, 5, 6, 338, 8983, 58203, 57330, 5788803),
    (182, 6, 82, 244, 9558, 66182, 418917, 2008979),
    (40, 4, 34, 178, 825, 60242, 621162, 8616326),
    (84, 4, 47, 877, 3953, 83544, 622038, 4004697),
    (106, 2, 40, 476, 1509, 76746, 787497, 5191618),
    (90, 2, 96, 640, 8200, 91418, 944866, 8362182),
    (143, 5, 34, 710, 1025, 13597, 292787, 1136995),
    (10, 0, 97, 333, 1746, 98384, 770109, 7276590),
    (22, 9, 4, 171, 8343, 36077, 87048, 4103074),
    (125, 8, 37, 430, 8820, 88328, 137510, 2536831),
    (167, 8, 36, 72, 6461, 4563, 892235, 4323669),
    (88, 5, 21, 684, 6242, 16628, 688491, 2852785),
    (127, 6, 94, 235, 9482, 23290, 494525, 32445),
    (42, 6, 39, 379, 5631, 51474, 506563, 4082086),
    (144, 5, 92, 158, 1891, 4846, 127501, 5091868),
    (66, 8, 59, 388, 2509, 7229, 450773, 4992666),
    (34, 7, 79, 669, 902, 89891, 435911, 1840339),
    (81, 4, 4, 967, 1170, 92808, 244868, 6029276),
    (25, 8, 35, 868, 8059, 52702, 124611, 2869517),
    (175, 6, 71, 776, 4998, 92846, 340124, 915006),
    (36, 1, 7, 485, 7138, 35984, 339740, 4215732),
    (74, 7, 64, 386, 121, 77691, 547614, 3943836),
    (3, 7, 23, 305, 3878, 93485, 43156, 3921438),
    (129, 7, 59, 139, 2438, 98470, 904917, 7754852),
    (149, 0, 52, 326, 7765, 24531, 959352, 7732143),
    (163, 1, 68, 950, 8610, 35696, 579122, 3084354),
    (153, 3, 68, 463, 5311, 94011, 82294, 1015581),
    (11, 2, 76, 69, 8076, 81619, 312257, 1930656),
    (46, 6, 9, 116, 5967, 41769, 283685, 4522930),
    (161, 0, 63, 491, 2590, 14553, 151667, 1239028),
    (152, 7, 66, 282, 4766, 22709, 526711, 7306101),
    (170, 8, 55, 672, 3974, 45487, 823761, 428878),
    (72, 2, 70, 903, 1712, 21708, 203630, 8093216),
    (85, 4, 80, 75, 2539, 68936, 828987, 2365244),
    (141, 6, 22, 289, 627, 56493, 111716, 2475428),
    (99, 7, 11, 724, 3662, 46405, 260985, 6094229),
    (17, 3, 8, 218, 7079, 29335, 522580, 1393348),
    (138, 7, 44, 600, 8991, 26953, 187679, 2491217),
    (114, 8, 32, 275, 6183, 44193, 380432, 1910962),
    (173, 0, 83, 100, 3367, 16621, 640206, 2773136),
    (50, 3, 46, 494, 6676, 50513, 230812, 8717166),
    (139, 4, 84, 497, 7487, 66828, 809011, 3037040),
    (150, 2, 98, 560, 6491, 73299, 766200, 2561789),
    (54, 1, 92, 136, 7375, 1615, 874417, 8532832),
    (62, 1, 52, 175, 7240, 70387, 28071, 3546585),
    (92, 2, 86, 754, 8935, 77526, 810276, 1884535),
    (194, 9, 84, 887, 8293, 57428, 13305, 4166625),
    (117, 6, 55, 784, 4148, 32330, 182024, 9606542),
    (104, 4, 74, 29, 8701, 73679, 99074, 6267512),
    (63, 4, 4, 198, 9352, 99004, 734374, 7638195),
    (118, 5, 61, 18, 6558, 77494, 823400, 7540500),
    (83, 1, 1, 314, 128, 50974, 855262, 5617222),
    (70, 9, 7, 631, 2287, 35350, 4649, 1123333),
    (130, 3, 92, 678, 4290, 33394, 223241, 3461293),
    (199, 9, 11, 91, 6896, 94319, 527602, 8222281),
    (26, 1, 37, 126, 7323, 60028, 910446, 8299621),
    (184, 1, 27, 665, 2372, 30282, 203725, 5814793),
    (122, 9, 77, 585, 7558, 32215, 911472, 837405),
    (44, 9, 19, 200, 2545, 70842, 89745, 3435765),
    (103, 7, 93, 707, 2350, 18066, 780695, 5926799),
    (78, 2, 36, 499, 7838, 6035, 419854, 6093766),
    (94, 8, 58, 110, 4757, 42114, 598073, 9891358),
    (134, 2, 25, 346, 9990, 97041, 996353, 6604388),
    (195, 2, 47, 637, 2139, 66667, 317043, 4354233),
    (56, 4, 8, 440, 7097, 29112, 428581, 405846),
    (157, 6, 67, 789, 572, 52215, 294088, 3587193),
    (20, 6, 88, 209, 7012, 96205, 849891, 8671682),
    (28, 8, 92, 585, 2310, 41334, 545418, 1334792),
    (4, 5, 2, 755, 2853, 34184, 414444, 171994),
    (181, 3, 85, 915, 8122, 62571, 639142, 8752584),
    (119, 5, 14, 618, 8072, 40581, 76034, 7244977),
    (197, 9, 99, 623, 6246, 23617, 514078, 8376894),
    (8, 0, 99, 699, 3253, 88194, 522672, 7341468),
    (2, 9, 39, 499, 7022, 86936, 848301, 746939),
    (192, 6, 74, 653, 2599, 52200, 760612, 7420299),
    (190, 6, 44, 51, 184, 43594, 329767, 9381954),
    (178, 0, 33, 773, 5278, 44429, 452382, 7142150),
    (164, 5, 80, 615, 4826, 89334, 216827, 6267318),
    (15, 4, 99, 43, 7336, 18702, 932476, 4751240),
    (76, 3, 27, 181, 1112, 30392, 427843, 6401112),
    (47, 7, 78, 119, 9233, 17182, 72665, 1921751),
    (6, 8, 91, 259, 9318, 22573, 724639, 9856469),
    (174, 7, 38, 163, 6614, 6389, 215981, 5410513),
    (113, 5, 70, 719, 9300, 57448, 47709, 9456206),
    (69, 7, 21, 434, 5673, 85399, 354546, 2362967),
    (45, 4, 71, 397, 3677, 2556, 316835, 5636529),
    (38, 1, 93, 307, 8805, 38987, 956976, 7329265),
    (29, 1, 73, 173, 3972, 18059, 968740, 9895271);


statement ok
create table temp_2(col1 int, col2 int, col3 int);

statement ok
insert into temp_2 values
    (5, 290, 5),
    (6, 592, 6),
    (0, 142, 0),
    (1, 993, 1),
    (2, 837, 2),
    (3, 380, 3),
    (4, 240, 4),
    (7, 88 , 7),
    (8, 194, 8),
    (9, 638, 9),
    (10, 290, 0),
    (11, 878, 1),
    (12, 170, 2),
    (13, 332, 3),
    (14, 680, 4),
    (15, 2, 5),
    (16, 552, 6),
    (17, 561, 7),
    (18, 398, 8),
    (19, 974, 9),
    (20, 739, 0),
    (21, 352, 1),
    (53, 770, 3),
    (39, 160, 9),
    (40, 917, 0),
    (41, 949, 1),
    (36, 259, 6),
    (37, 812, 7),
    (38, 194, 8),
    (47, 399, 7),
    (48, 924, 8),
    (49, 731, 9),
    (50, 8  , 0),
    (51, 219, 1),
    (52, 276, 2),
    (55, 390, 5),
    (56, 419, 6),
    (57, 346, 7),
    (58, 898, 8),
    (59, 396, 9),
    (60, 221, 0),
    (61, 208, 1),
    (84, 711, 4),
    (85, 779, 5),
    (86, 648, 6),
    (87, 590, 7),
    (88, 241, 8),
    (89, 929, 9),
    (90, 914, 0),
    (91, 449, 1),
    (92, 815, 2),
    (93, 225, 3),
    (54, 991, 4),
    (22, 387, 2),
    (23, 598, 3),
    (24, 440, 4),
    (25, 83, 5),
    (26, 57, 6),
    (27, 883, 7),
    (28, 914, 8),
    (29, 538, 9),
    (30, 132, 0),
    (31, 723, 1),
    (62, 934, 2),
    (63, 510, 3),
    (64, 147, 4),
    (65, 156, 5),
    (66, 529, 6),
    (67, 86 , 7),
    (68, 384, 8),
    (69, 603, 9),
    (70, 107, 0),
    (71, 867, 1),
    (42, 42 , 2),
    (43, 272, 3),
    (44, 975, 4),
    (45, 518, 5),
    (46, 930, 6),
    (79, 125, 9),
    (80, 400, 0),
    (81, 187, 1),
    (82, 982, 2),
    (83, 641, 3),
    (94, 377, 4),
    (95, 120, 5),
    (96, 662, 6),
    (97, 277, 7),
    (98, 351, 8),
    (32, 666, 2),
    (33, 701, 3),
    (34, 311, 4),
    (35, 214, 5),
    (72, 253, 2),
    (73, 782, 3),
    (74, 124, 4),
    (75, 879, 5),
    (76, 34 , 6),
    (77, 143, 7),
    (78, 494, 8),
    (99, 722, 9);

query
select col2, col4, col1, col3, col5, col6, col7, col8 from temp_1 order by col2 desc, col4, col1 desc limit 50;
----
9 91 199 11 6896 94319 527602 8222281
9 147 196 79 766 65018 580420 3460119
9 171 22 4 8343 36077 87048 4103074
9 200 44 19 2545 70842 89745 3435765
9 211 53 42 9846 61097 684453 4213854
9 243 39 84 4208 14273 384043 1263705
9 285 32 13 3097 3996 395731 7687792
9 345 133 66 4546 17571 408146 8155891
9 499 2 39 7022 86936 848301 746939
9 546 172 22 8088 89284 964185 39966
9 565 136 75 8630 41623 545551 2020603
9 585 122 77 7558 32215 911472 837405
9 623 197 99 6246 23617 514078 8376894
9 631 70 7 2287 35350 4649 1123333
9 674 96 73 5266 132 141779 9085955
9 823 79 28 8590 23300 806801 9298308
9 831 185 84 7327 14708 5597 5096306
9 887 194 84 8293 57428 13305 4166625
9 888 186 78 7407 52027 924097 8606329
9 896 37 44 6733 59844 347449 4470115
8 72 167 36 6461 4563 892235 4323669
8 77 112 60 6057 41809 524022 7077061
8 110 94 58 4757 42114 598073 9891358
8 154 7 11 8374 74676 497239 7923921
8 165 30 54 8934 10717 200689 8326241
8 259 6 91 9318 22573 724639 9856469
8 275 114 32 6183 44193 380432 1910962
8 351 124 69 4670 77529 139759 8776939
8 388 66 59 2509 7229 450773 4992666
8 430 125 37 8820 88328 137510 2536831
8 508 18 10 1933 54020 125384 813451
8 516 48 58 1321 9104 689086 7547836
8 552 166 47 6515 66148 324278 1957978
8 561 0 5 9989 87361 494821 5840702
8 571 160 70 7936 22902 603269 8680300
8 585 28 92 2310 41334 545418 1334792
8 636 176 34 7301 47976 569899 9218292
8 665 142 97 9823 46844 383619 6444628
8 672 170 55 3974 45487 823761 428878
8 708 193 65 9371 99964 37220 3893300
8 851 168 7 2023 46784 687310 4103789
8 868 25 35 8059 52702 124611 2869517
8 963 116 77 5488 30956 928245 7855578
7 79 179 36 9115 60534 741330 5927650
7 119 47 78 9233 17182 72665 1921751
7 129 87 29 5132 30303 378736 2741233
7 139 129 59 2438 98470 904917 7754852
7 163 174 38 6614 6389 215981 5410513
7 168 120 16 6744 9691 204061 4253805
7 226 65 46 4705 84312 973089 4319545



query
select * from temp_1 order by col2 desc, col1 + col4 - col1 desc, col1 asc limit 30;
----
37 9 44 896 6733 59844 347449 4470115
186 9 78 888 7407 52027 924097 8606329
194 9 84 887 8293 57428 13305 4166625
185 9 84 831 7327 14708 5597 5096306
79 9 28 823 8590 23300 806801 9298308
96 9 73 674 5266 132 141779 9085955
70 9 7 631 2287 35350 4649 1123333
197 9 99 623 6246 23617 514078 8376894
122 9 77 585 7558 32215 911472 837405
136 9 75 565 8630 41623 545551 2020603
172 9 22 546 8088 89284 964185 39966
2 9 39 499 7022 86936 848301 746939
133 9 66 345 4546 17571 408146 8155891
32 9 13 285 3097 3996 395731 7687792
39 9 84 243 4208 14273 384043 1263705
53 9 42 211 9846 61097 684453 4213854
44 9 19 200 2545 70842 89745 3435765
22 9 4 171 8343 36077 87048 4103074
196 9 79 147 766 65018 580420 3460119
199 9 11 91 6896 94319 527602 8222281
116 8 77 963 5488 30956 928245 7855578
25 8 35 868 8059 52702 124611 2869517
168 8 7 851 2023 46784 687310 4103789
193 8 65 708 9371 99964 37220 3893300
170 8 55 672 3974 45487 823761 428878
142 8 97 665 9823 46844 383619 6444628
176 8 34 636 7301 47976 569899 9218292
28 8 92 585 2310 41334 545418 1334792
160 8 70 571 7936 22902 603269 8680300
0 8 5 561 9989 87361 494821 5840702

query
select col1 from (select col3, col1, col2, from temp_2 order by col3 - col2 + col1, col1 limit 20);
----
1
19
54
44
41
82
28
46
40
62
48
11
27
2
58
89
90
75
71
37


# Repeat
query rowsort
select * from __mock_table_123, (select * from temp_1 order by col1 desc limit 3);
----
1 199 9 11 91 6896 94319 527602 8222281
1 198 0 99 778 1528 52316 726477 8219397
1 197 9 99 623 6246 23617 514078 8376894
2 199 9 11 91 6896 94319 527602 8222281
2 198 0 99 778 1528 52316 726477 8219397
2 197 9 99 623 6246 23617 514078 8376894
3 199 9 11 91 6896 94319 527602 8222281
3 198 0 99 778 1528 52316 726477 8219397
3 197 9 99 623 6246 23617 514078 8376894

# remember to enable your hash join optimizer to pass this
# you could disable this ensure if you haven't implemented it yet
query rowsort +ensure:hash_join
select * from
    temp_2 t2 inner join
    (select col2, col4, col1, col3 from temp_1 order by col2 desc, col4, col1 desc limit 30 ) t1
    on t1.col1 = t2.col1;
----
22 387 2 9 171 22 4
44 975 4 9 200 44 19
53 770 3 9 211 53 42
39 160 9 9 243 39 84
32 666 2 9 285 32 13
2 837 2 9 499 2 39
70 107 0 9 631 70 7
96 662 6 9 674 96 73
79 125 9 9 823 79 28
37 812 7 9 896 37 44
94 377 4 8 110 94 58
7 88 7 8 154 7 11
30 132 0 8 165 30 54
6 592 6 8 259 6 91
66 529 6 8 388 66 59


# Very large amount of data, spanning multiple sort pages in external merge sort
query
select * from __mock_external_merge_sort_input order by v2 desc, v3 asc limit 100;
----
13222 14999 16
28222 14999 31
43222 14999 46
58222 14999 61
73222 14999 76
88222 14999 91
13221 14998 15
28221 14998 30
43221 14998 45
58221 14998 60
73221 14998 75
88221 14998 90
13220 14997 14
28220 14997 29
43220 14997 44
58220 14997 59
73220 14997 74
88220 14997 89
13219 14996 13
28219 14996 28
43219 14996 43
58219 14996 58
73219 14996 73
88219 14996 88
13218 14995 12
28218 14995 27
43218 14995 42
58218 14995 57
73218 14995 72
88218 14995 87
13217 14994 11
28217 14994 26
43217 14994 41
58217 14994 56
73217 14994 71
88217 14994 86
13216 14993 10
28216 14993 25
43216 14993 40
58216 14993 55
73216 14993 70
88216 14993 85
13215 14992 9
28215 14992 24
43215 14992 39
58215 14992 54
73215 14992 69
88215 14992 84
13214 14991 8
28214 14991 23
43214 14991 38
58214 14991 53
73214 14991 68
88214 14991 83
13213 14990 7
28213 14990 22
43213 14990 37
58213 14990 52
73213 14990 67
88213 14990 82
13212 14989 6
28212 14989 21
43212 14989 36
58212 14989 51
73212 14989 66
88212 14989 81
13211 14988 5
28211 14988 20
43211 14988 35
58211 14988 50
73211 14988 65
88211 14988 80
13210 14987 4
28210 14987 19
43210 14987 34
58210 14987 49
73210 14987 64
88210 14987 79
13209 14986 3
28209 14986 18
43209 14986 33
58209 14986 48
73209 14986 63
88209 14986 78
13208 14985 2
28208 14985 17
43208 14985 32
58208 14985 47
73208 14985 62
88208 14985 77
13207 14984 1
28207 14984 16
43207 14984 31
58207 14984 46
73207 14984 61
88207 14984 76
13206 14983 0
28206 14983 15
43206 14983 30
58206 14983 45


# remember to enable your hash join optimizer to pass this
# you could disable this ensure if you haven't implemented it yet
query rowsort +ensure:hash_join
select * from
    (select * from __mock_external_merge_sort_input order by v1 + v2 limit 2000) t1
    inner join __mock_table_1
    on t1.v2 = __mock_table_1.colB;
----
23 1800 26 18 1800
123 1900 15 19 1900
223 2000 4 20 2000
323 2100 104 21 2100
423 2200 93 22 2200
523 2300 82 23 2300
623 2400 71 24 2400
723 2500 60 25 2500
823 2600 49 26 2600
923 2700 38 27 2700
1023 2800 27 28 2800
1123 2900 16 29 2900
1223 3000 5 30 3000
1323 3100 105 31 3100
1423 3200 94 32 3200
1523 3300 83 33 3300
1623 3400 72 34 3400
1723 3500 61 35 3500
1823 3600 50 36 3600
1923 3700 39 37 3700


statement ok
create table temp_3(v1 int, v2 varchar(128), v3 int, v4 int, v5 int, v6 int, v7 int, v8 int);

statement ok
insert into temp_3 values
(0, '', 10, 100, 200, 300, 400, 500),  
(1, 'ðŸ¥°', 11, 100, 200, 300, 400, 500), 
(2, 'ðŸ¥°ðŸ¥°', 12, 100, 200, 300, 400, 500), 
(3, 'ðŸ¥°ðŸ¥°ðŸ¥°', 13, 100, 200, 300, 400, 500), 
(4, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 14, 100, 200, 300, 400, 500), 
(5, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 15, 100, 200, 300, 400, 500), 
(6, '', 16, 100, 200, 300, 400, 500), 
(7, 'ðŸ¥°', 17, 100, 200, 300, 400, 500), 
(8, 'ðŸ¥°ðŸ¥°', 18, 100, 200, 300, 400, 500), 
(9, 'ðŸ¥°ðŸ¥°ðŸ¥°', 19, 100, 200, 300, 400, 500), 
(10, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 20, 100, 200, 300, 400, 500), 
(11, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 21, 100, 200, 300, 400, 500), 
(12, '', 22, 100, 200, 300, 400, 500), 
(13, 'ðŸ¥°', 23, 100, 200, 300, 400, 500), 
(14, 'ðŸ¥°ðŸ¥°', 24, 100, 200, 300, 400, 500), 
(15, 'ðŸ¥°ðŸ¥°ðŸ¥°', 25, 100, 200, 300, 400, 500), 
(16, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 26, 100, 200, 300, 400, 500), 
(17, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 27, 100, 200, 300, 400, 500), 
(18, '', 28, 100, 200, 300, 400, 500), 
(19, 'ðŸ¥°', 29, 100, 200, 300, 400, 500), 
(20, 'ðŸ¥°ðŸ¥°', 30, 100, 200, 300, 400, 500), 
(21, 'ðŸ¥°ðŸ¥°ðŸ¥°', 31, 100, 200, 300, 400, 500), 
(22, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 32, 100, 200, 300, 400, 500), 
(23, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 33, 100, 200, 300, 400, 500), 
(24, '', 34, 100, 200, 300, 400, 500), 
(25, 'ðŸ¥°', 35, 100, 200, 300, 400, 500), 
(26, 'ðŸ¥°ðŸ¥°', 36, 100, 200, 300, 400, 500), 
(27, 'ðŸ¥°ðŸ¥°ðŸ¥°', 37, 100, 200, 300, 400, 500), 
(28, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 38, 100, 200, 300, 400, 500), 
(29, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 39, 100, 200, 300, 400, 500), 
(30, '', 40, 100, 200, 300, 400, 500), 
(31, 'ðŸ¥°', 41, 100, 200, 300, 400, 500), 
(32, 'ðŸ¥°ðŸ¥°', 42, 100, 200, 300, 400, 500), 
(33, 'ðŸ¥°ðŸ¥°ðŸ¥°', 43, 100, 200, 300, 400, 500), 
(34, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 44, 100, 200, 300, 400, 500), 
(35, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 45, 100, 200, 300, 400, 500), 
(36, '', 46, 100, 200, 300, 400, 500), 
(37, 'ðŸ¥°', 47, 100, 200, 300, 400, 500), 
(38, 'ðŸ¥°ðŸ¥°', 48, 100, 200, 300, 400, 500), 
(39, 'ðŸ¥°ðŸ¥°ðŸ¥°', 49, 100, 200, 300, 400, 500), 
(40, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 50, 100, 200, 300, 400, 500), 
(41, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 51, 100, 200, 300, 400, 500), 
(42, '', 52, 100, 200, 300, 400, 500), 
(43, 'ðŸ¥°', 53, 100, 200, 300, 400, 500), 
(44, 'ðŸ¥°ðŸ¥°', 54, 100, 200, 300, 400, 500), 
(45, 'ðŸ¥°ðŸ¥°ðŸ¥°', 55, 100, 200, 300, 400, 500), 
(46, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 56, 100, 200, 300, 400, 500), 
(47, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 57, 100, 200, 300, 400, 500), 
(48, '', 58, 100, 200, 300, 400, 500), 
(49, 'ðŸ¥°', 59, 100, 200, 300, 400, 500), 
(50, 'ðŸ¥°ðŸ¥°', 60, 100, 200, 300, 400, 500), 
(51, 'ðŸ¥°ðŸ¥°ðŸ¥°', 61, 100, 200, 300, 400, 500), 
(52, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 62, 100, 200, 300, 400, 500), 
(53, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 63, 100, 200, 300, 400, 500), 
(54, '', 64, 100, 200, 300, 400, 500), 
(55, 'ðŸ¥°', 65, 100, 200, 300, 400, 500), 
(56, 'ðŸ¥°ðŸ¥°', 66, 100, 200, 300, 400, 500), 
(57, 'ðŸ¥°ðŸ¥°ðŸ¥°', 67, 100, 200, 300, 400, 500), 
(58, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 68, 100, 200, 300, 400, 500), 
(null, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 69, 100, 200, 300, 400, 500), 
(60, '', 70, 100, 200, 300, 400, 500), 
(61, 'ðŸ¥°', 71, 100, 200, 300, 400, 500), 
(62, 'ðŸ¥°ðŸ¥°', 72, 100, 200, 300, 400, 500), 
(63, 'ðŸ¥°ðŸ¥°ðŸ¥°', 73, 100, 200, 300, 400, 500), 
(64, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 74, 100, 200, 300, 400, 500), 
(null, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 75, 100, 200, 300, 400, 500), 
(66, '', 76, 100, 200, 300, 400, 500), 
(67, 'ðŸ¥°', 77, 100, 200, 300, 400, 500), 
(68, 'ðŸ¥°ðŸ¥°', 78, 100, 200, 300, 400, 500), 
(69, 'ðŸ¥°ðŸ¥°ðŸ¥°', 79, 100, 200, 300, 400, 500), 
(70, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 80, 100, 200, 300, 400, 500), 
(71, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 81, 100, 200, 300, 400, 500), 
(72, '', 82, 100, 200, 300, 400, 500), 
(73, 'ðŸ¥°', 83, 100, 200, 300, 400, 500), 
(74, 'ðŸ¥°ðŸ¥°', 84, 100, 200, 300, 400, 500), 
(75, 'ðŸ¥°ðŸ¥°ðŸ¥°', 85, 100, 200, 300, 400, 500), 
(76, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 86, 100, 200, 300, 400, 500), 
(77, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 87, 100, 200, 300, 400, 500), 
(78, '', 88, 100, 200, 300, 400, 500), 
(79, 'ðŸ¥°', 89, 100, 200, 300, 400, 500), 
(80, 'ðŸ¥°ðŸ¥°', 90, 100, 200, 300, 400, 500), 
(81, 'ðŸ¥°ðŸ¥°ðŸ¥°', 91, 100, 200, 300, 400, 500), 
(82, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 92, 100, 200, 300, 400, 500), 
(83, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 93, 100, 200, 300, 400, 500), 
(84, '', 94, 100, 200, 300, 400, 500), 
(85, 'ðŸ¥°', 95, 100, 200, 300, 400, 500), 
(86, 'ðŸ¥°ðŸ¥°', 96, 100, 200, 300, 400, 500), 
(87, 'ðŸ¥°ðŸ¥°ðŸ¥°', 97, 100, 200, 300, 400, 500), 
(88, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 98, 100, 200, 300, 400, 500), 
(89, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 99, 100, 200, 300, 400, 500), 
(90, '', 100, 100, 200, 300, 400, 500), 
(91, 'ðŸ¥°', 101, 100, 200, 300, 400, 500), 
(92, 'ðŸ¥°ðŸ¥°', 102, 100, 200, 300, 400, 500), 
(93, 'ðŸ¥°ðŸ¥°ðŸ¥°', 103, 100, 200, 300, 400, 500), 
(94, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 104, 100, 200, 300, 400, 500), 
(95, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 105, 100, 200, 300, 400, 500), 
(96, '', 106, 100, 200, 300, 400, 500), 
(97, 'ðŸ¥°', 107, 100, 200, 300, 400, 500), 
(98, 'ðŸ¥°ðŸ¥°', 108, 100, 200, 300, 400, 500), 
(99, 'ðŸ¥°ðŸ¥°ðŸ¥°', 109, 100, 200, 300, 400, 500), 
(100, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 110, 100, 200, 300, 400, 500), 
(101, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 111, 100, 200, 300, 400, 500), 
(102, '', 112, 100, 200, 300, 400, 500), 
(103, 'ðŸ¥°', 113, 100, 200, 300, 400, 500), 
(104, 'ðŸ¥°ðŸ¥°', 114, 100, 200, 300, 400, 500), 
(105, 'ðŸ¥°ðŸ¥°ðŸ¥°', 115, 100, 200, 300, 400, 500), 
(106, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 116, 100, 200, 300, 400, 500), 
(107, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 117, 100, 200, 300, 400, 500), 
(108, '', 118, 100, 200, 300, 400, 500), 
(109, 'ðŸ¥°', 119, 100, 200, 300, 400, 500), 
(110, 'ðŸ¥°ðŸ¥°', 120, 100, 200, 300, 400, 500), 
(111, 'ðŸ¥°ðŸ¥°ðŸ¥°', 121, 100, 200, 300, 400, 500), 
(112, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 122, 100, 200, 300, 400, 500), 
(113, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 123, 100, 200, 300, 400, 500), 
(114, '', 124, 100, 200, 300, 400, 500), 
(115, 'ðŸ¥°', 125, 100, 200, 300, 400, 500), 
(116, 'ðŸ¥°ðŸ¥°', 126, 100, 200, 300, 400, 500), 
(117, 'ðŸ¥°ðŸ¥°ðŸ¥°', 127, 100, 200, 300, 400, 500), 
(118, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 128, 100, 200, 300, 400, 500), 
(119, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 129, 100, 200, 300, 400, 500), 
(120, '', 130, 100, 200, 300, 400, 500), 
(121, 'ðŸ¥°', 131, 100, 200, 300, 400, 500), 
(122, 'ðŸ¥°ðŸ¥°', 132, 100, 200, 300, 400, 500), 
(123, 'ðŸ¥°ðŸ¥°ðŸ¥°', 133, 100, 200, 300, 400, 500), 
(124, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 134, 100, 200, 300, 400, 500), 
(125, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 135, 100, 200, 300, 400, 500), 
(126, '', 136, 100, 200, 300, 400, 500), 
(127, 'ðŸ¥°', 137, 100, 200, 300, 400, 500), 
(128, 'ðŸ¥°ðŸ¥°', 138, 100, 200, 300, 400, 500), 
(129, 'ðŸ¥°ðŸ¥°ðŸ¥°', 139, 100, 200, 300, 400, 500), 
(130, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 140, 100, 200, 300, 400, 500), 
(131, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 141, 100, 200, 300, 400, 500), 
(132, '', 142, 100, 200, 300, 400, 500), 
(133, 'ðŸ¥°', 143, 100, 200, 300, 400, 500), 
(134, 'ðŸ¥°ðŸ¥°', 144, 100, 200, 300, 400, 500), 
(135, 'ðŸ¥°ðŸ¥°ðŸ¥°', 145, 100, 200, 300, 400, 500), 
(136, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 146, 100, 200, 300, 400, 500), 
(null, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 147, 100, 200, 300, 400, 500), 
(138, '', 148, 100, 200, 300, 400, 500), 
(139, 'ðŸ¥°', 149, 100, 200, 300, 400, 500), 
(140, 'ðŸ¥°ðŸ¥°', 150, 100, 200, 300, 400, 500), 
(141, 'ðŸ¥°ðŸ¥°ðŸ¥°', 151, 100, 200, 300, 400, 500), 
(142, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 152, 100, 200, 300, 400, 500), 
(143, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 153, 100, 200, 300, 400, 500), 
(144, '', 154, 100, 200, 300, 400, 500), 
(145, 'ðŸ¥°', 155, 100, 200, 300, 400, 500), 
(146, 'ðŸ¥°ðŸ¥°', 156, 100, 200, 300, 400, 500), 
(147, 'ðŸ¥°ðŸ¥°ðŸ¥°', 157, 100, 200, 300, 400, 500), 
(148, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 158, 100, 200, 300, 400, 500), 
(149, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 159, 100, 200, 300, 400, 500), 
(150, '', 160, 100, 200, 300, 400, 500), 
(151, 'ðŸ¥°', 161, 100, 200, 300, 400, 500), 
(152, 'ðŸ¥°ðŸ¥°', 162, 100, 200, 300, 400, 500), 
(153, 'ðŸ¥°ðŸ¥°ðŸ¥°', 163, 100, 200, 300, 400, 500), 
(154, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 164, 100, 200, 300, 400, 500), 
(155, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 165, 100, 200, 300, 400, 500), 
(156, '', 166, 100, 200, 300, 400, 500), 
(157, 'ðŸ¥°', 167, 100, 200, 300, 400, 500), 
(158, 'ðŸ¥°ðŸ¥°', 168, 100, 200, 300, 400, 500), 
(159, 'ðŸ¥°ðŸ¥°ðŸ¥°', 169, 100, 200, 300, 400, 500), 
(160, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 170, 100, 200, 300, 400, 500), 
(161, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 171, 100, 200, 300, 400, 500), 
(162, '', 172, 100, 200, 300, 400, 500), 
(163, 'ðŸ¥°', 173, 100, 200, 300, 400, 500), 
(164, 'ðŸ¥°ðŸ¥°', 174, 100, 200, 300, 400, 500), 
(165, 'ðŸ¥°ðŸ¥°ðŸ¥°', 175, 100, 200, 300, 400, 500), 
(166, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 176, 100, 200, 300, 400, 500), 
(167, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 177, 100, 200, 300, 400, 500), 
(168, '', 178, 100, 200, 300, 400, 500), 
(169, 'ðŸ¥°', 179, 100, 200, 300, 400, 500), 
(170, 'ðŸ¥°ðŸ¥°', 180, 100, 200, 300, 400, 500), 
(171, 'ðŸ¥°ðŸ¥°ðŸ¥°', 181, 100, 200, 300, 400, 500), 
(172, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 182, 100, 200, 300, 400, 500), 
(173, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 183, 100, 200, 300, 400, 500), 
(174, '', 184, 100, 200, 300, 400, 500), 
(175, 'ðŸ¥°', 185, 100, 200, 300, 400, 500), 
(176, 'ðŸ¥°ðŸ¥°', 186, 100, 200, 300, 400, 500), 
(177, 'ðŸ¥°ðŸ¥°ðŸ¥°', 187, 100, 200, 300, 400, 500), 
(178, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 188, 100, 200, 300, 400, 500), 
(179, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 189, 100, 200, 300, 400, 500), 
(180, '', 190, 100, 200, 300, 400, 500), 
(181, 'ðŸ¥°', 191, 100, 200, 300, 400, 500), 
(182, 'ðŸ¥°ðŸ¥°', 192, 100, 200, 300, 400, 500), 
(183, 'ðŸ¥°ðŸ¥°ðŸ¥°', 193, 100, 200, 300, 400, 500), 
(184, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 194, 100, 200, 300, 400, 500), 
(185, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 195, 100, 200, 300, 400, 500), 
(186, '', 196, 100, 200, 300, 400, 500), 
(187, 'ðŸ¥°', 197, 100, 200, 300, 400, 500), 
(188, 'ðŸ¥°ðŸ¥°', 198, 100, 200, 300, 400, 500), 
(189, 'ðŸ¥°ðŸ¥°ðŸ¥°', 199, 100, 200, 300, 400, 500), 
(190, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 200, 100, 200, 300, 400, 500), 
(191, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 201, 100, 200, 300, 400, 500), 
(192, '', 202, 100, 200, 300, 400, 500), 
(193, 'ðŸ¥°', 203, 100, 200, 300, 400, 500), 
(194, 'ðŸ¥°ðŸ¥°', 204, 100, 200, 300, 400, 500), 
(195, 'ðŸ¥°ðŸ¥°ðŸ¥°', 205, 100, 200, 300, 400, 500), 
(196, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 206, 100, 200, 300, 400, 500), 
(197, 'ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°', 207, 100, 200, 300, 400, 500), 
(198, '', 208, 100, 200, 300, 400, 500), 
(199, 'ðŸ¥°', 209, 100, 200, 300, 400, 500);

query
select * from temp_3 order by v2 desc, v1 asc nulls first, v3 desc limit 10;
----
integer_null ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 147 100 200 300 400 500 
integer_null ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 75 100 200 300 400 500 
integer_null ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 69 100 200 300 400 500 
5 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 15 100 200 300 400 500 
11 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 21 100 200 300 400 500 
17 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 27 100 200 300 400 500 
23 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 33 100 200 300 400 500 
29 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 39 100 200 300 400 500 
35 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 45 100 200 300 400 500 
41 ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥°ðŸ¥° 51 100 200 300 400 500 

query
select v1, v2 from (select v1, v2, v5, v6, v5 + v6, v3, v4, v3 - v4 from temp_3 order by v1 desc limit 25) order by v2, v1 limit 5;
----
180  
186  
192  
198  
175 ðŸ¥° 