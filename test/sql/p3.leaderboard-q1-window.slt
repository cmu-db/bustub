statement ok
explain (o) select x, y from (
 select x, y, rank() over (partition by x order by y) as rank
 from __mock_t9
) where rank <= 3;

query nosort +timing:x10:.q1
select x, y from (
 select x, y, rank() over (partition by x order by y) as rank
 from __mock_t9
) where rank <= 3;
----
0 0
0 0
0 1
0 1
1 5000
1 5000
1 5002
1 5002
1 5002
1 5002
2 10000
2 10000
2 10001
2 10001
3 15000
3 15000
3 15002
3 15002
3 15002
3 15002
4 20000
4 20000
4 20001
4 20001
5 25000
5 25000
5 25002
5 25002
5 25002
5 25002
6 30000
6 30000
6 30001
6 30001
7 35000
7 35000
7 35002
7 35002
7 35002
7 35002
8 40000
8 40000
8 40001
8 40001
9 45000
9 45000
9 45002
9 45002
9 45002
9 45002
10 50000
10 50000
10 50001
10 50001
11 55000
11 55000
11 55002
11 55002
11 55002
11 55002
12 60000
12 60000
12 60001
12 60001
13 65000
13 65000
13 65002
13 65002
13 65002
13 65002
14 70000
14 70000
14 70001
14 70001
15 75000
15 75000
15 75002
15 75002
15 75002
15 75002
16 80000
16 80000
16 80001
16 80001
17 85000
17 85000
17 85002
17 85002
17 85002
17 85002
18 90000
18 90000
18 90001
18 90001
19 95000
19 95000
19 95002
19 95002
19 95002
19 95002
20 100000
20 100000
20 100001
20 100001
21 105000
21 105000
21 105002
21 105002
21 105002
21 105002
22 110000
22 110000
22 110001
22 110001
23 115000
23 115000
23 115002
23 115002
23 115002
23 115002
24 120000
24 120000
24 120001
24 120001
25 125000
25 125000
25 125002
25 125002
25 125002
25 125002
26 130000
26 130000
26 130001
26 130001
27 135000
27 135000
27 135002
27 135002
27 135002
27 135002
28 140000
28 140000
28 140001
28 140001
29 145000
29 145000
29 145002
29 145002
29 145002
29 145002
30 150000
30 150000
30 150001
30 150001
31 155000
31 155000
31 155002
31 155002
31 155002
31 155002
32 160000
32 160000
32 160001
32 160001
33 165000
33 165000
33 165002
33 165002
33 165002
33 165002
34 170000
34 170000
34 170001
34 170001
35 175000
35 175000
35 175002
35 175002
35 175002
35 175002
36 180000
36 180000
36 180001
36 180001
37 185000
37 185000
37 185002
37 185002
37 185002
37 185002
38 190000
38 190000
38 190001
38 190001
39 195000
39 195000
39 195002
39 195002
39 195002
39 195002
40 200000
40 200000
40 200001
40 200001
41 205000
41 205000
41 205002
41 205002
41 205002
41 205002
42 210000
42 210000
42 210001
42 210001
43 215000
43 215000
43 215002
43 215002
43 215002
43 215002
44 220000
44 220000
44 220001
44 220001
45 225000
45 225000
45 225002
45 225002
45 225002
45 225002
46 230000
46 230000
46 230001
46 230001
47 235000
47 235000
47 235002
47 235002
47 235002
47 235002
48 240000
48 240000
48 240001
48 240001
49 245000
49 245000
49 245002
49 245002
49 245002
49 245002
50 250000
50 250000
50 250001
50 250001
51 255000
51 255000
51 255002
51 255002
51 255002
51 255002
52 260000
52 260000
52 260001
52 260001
53 265000
53 265000
53 265002
53 265002
53 265002
53 265002
54 270000
54 270000
54 270001
54 270001
55 275000
55 275000
55 275002
55 275002
55 275002
55 275002
56 280000
56 280000
56 280001
56 280001
57 285000
57 285000
57 285002
57 285002
57 285002
57 285002
58 290000
58 290000
58 290001
58 290001
59 295000
59 295000
59 295002
59 295002
59 295002
59 295002
60 300000
60 300000
60 300001
60 300001
61 305000
61 305000
61 305002
61 305002
61 305002
61 305002
62 310000
62 310000
62 310001
62 310001
63 315000
63 315000
63 315002
63 315002
63 315002
63 315002
64 320000
64 320000
64 320001
64 320001
65 325000
65 325000
65 325002
65 325002
65 325002
65 325002
66 330000
66 330000
66 330001
66 330001
67 335000
67 335000
67 335002
67 335002
67 335002
67 335002
68 340000
68 340000
68 340001
68 340001
69 345000
69 345000
69 345002
69 345002
69 345002
69 345002
70 350000
70 350000
70 350001
70 350001
71 355000
71 355000
71 355002
71 355002
71 355002
71 355002
72 360000
72 360000
72 360001
72 360001
73 365000
73 365000
73 365002
73 365002
73 365002
73 365002
74 370000
74 370000
74 370001
74 370001
75 375000
75 375000
75 375002
75 375002
75 375002
75 375002
76 380000
76 380000
76 380001
76 380001
77 385000
77 385000
77 385002
77 385002
77 385002
77 385002
78 390000
78 390000
78 390001
78 390001
79 395000
79 395000
79 395002
79 395002
79 395002
79 395002
80 400000
80 400000
80 400001
80 400001
81 405000
81 405000
81 405002
81 405002
81 405002
81 405002
82 410000
82 410000
82 410001
82 410001
83 415000
83 415000
83 415002
83 415002
83 415002
83 415002
84 420000
84 420000
84 420001
84 420001
85 425000
85 425000
85 425002
85 425002
85 425002
85 425002
86 430000
86 430000
86 430001
86 430001
87 435000
87 435000
87 435002
87 435002
87 435002
87 435002
88 440000
88 440000
88 440001
88 440001
89 445000
89 445000
89 445002
89 445002
89 445002
89 445002
90 450000
90 450000
90 450001
90 450001
91 455000
91 455000
91 455002
91 455002
91 455002
91 455002
92 460000
92 460000
92 460001
92 460001
93 465000
93 465000
93 465002
93 465002
93 465002
93 465002
94 470000
94 470000
94 470001
94 470001
95 475000
95 475000
95 475002
95 475002
95 475002
95 475002
96 480000
96 480000
96 480001
96 480001
97 485000
97 485000
97 485002
97 485002
97 485002
97 485002
98 490000
98 490000
98 490001
98 490001
99 495000
99 495000
99 495002
99 495002
99 495002
99 495002
