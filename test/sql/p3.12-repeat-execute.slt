# 5 pts
# Put everything on the right side of NLJ

statement ok
create table t1(v1 int, v2 varchar(128));

query
insert into t1 values (0, 'ğŸ¥°'), (1, 'ğŸ¥°ğŸ¥°');
----
2

# SeqScan as the right child

query rowsort +ensure:nlj_init_check
select * from __mock_table_123, t1;
----
1 0 ğŸ¥° 
1 1 ğŸ¥°ğŸ¥° 
2 0 ğŸ¥° 
2 1 ğŸ¥°ğŸ¥° 
3 0 ğŸ¥° 
3 1 ğŸ¥°ğŸ¥°

# SimpleAgg as the right child

query rowsort +ensure:nlj_init_check
select * from __mock_table_123, (select count(*) as cnt from t1);
----
1 2
2 2
3 2

# GroupAgg as the right child

query rowsort +ensure:nlj_init_check
select * from __mock_table_123, (select distinct v2 from t1);
----
1 ğŸ¥°ğŸ¥° 
1 ğŸ¥° 
2 ğŸ¥°ğŸ¥° 
2 ğŸ¥° 
3 ğŸ¥°ğŸ¥° 
3 ğŸ¥°

# IndexScan as the right child

statement ok
create index t1v1 on t1(v1);

query rowsort +ensure:nlj_init_check
select * from __mock_table_123, (select * from t1 order by v1);
----
1 0 ğŸ¥° 
1 1 ğŸ¥°ğŸ¥° 
2 0 ğŸ¥° 
2 1 ğŸ¥°ğŸ¥° 
3 0 ğŸ¥° 
3 1 ğŸ¥°ğŸ¥°

# TODO: limit + repeat
